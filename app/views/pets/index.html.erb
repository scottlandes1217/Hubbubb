<% content_for :navbar do %>
  <%= render 'shared/navbar_org' %>
<% end %>

<div data-controller="pets-index list-view">
  <%= render 'shared/list_view',
      organization: @organization,
      object_type: 'Pet',
      object_id: nil,
      records: @pets,
      new_record_path: new_organization_pet_path(@organization),
      record_path_proc: ->(pet) { organization_pet_path(@organization, pet) },
      columns: @columns,
      current_view: @current_view,
      custom_actions: ->(record) {
        pet = record
        capture do
          %>
          <!-- Pin button -->
          <button class="btn btn-outline-secondary btn-sm pin-pet-btn <%= 'pinned' if @pinned_pet_ids.include?(pet.id) %>"
                  data-pet-id="<%= pet.id %>"
                  data-initial-pinned="<%= @pinned_pet_ids.include?(pet.id) %>"
                  data-action="click->pets-index#togglePin"
                  title="<%= @pinned_pet_ids.include?(pet.id) ? 'Unpin from navigation' : 'Pin to navigation' %>">
            <i class="fas fa-thumbtack <%= 'text-warning' if @pinned_pet_ids.include?(pet.id) %>"></i>
          </button>
          
          <!-- Delete button -->
          <%= link_to "Delete", organization_pet_path(@organization, pet), 
                      data: { turbo_method: "delete", turbo_confirm: "Are you sure you want to delete this pet?" }, 
                      class: "btn btn-danger btn-sm" %>
          <%
        end
      } %>
</div>